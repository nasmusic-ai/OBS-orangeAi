<!DOCTYPE html>
<!-- index.html -->
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no" />
  <title>Mini Streamer v5</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css" />
  <script src="https://cdn.jsdelivr.net/npm/three@0.165/build/three.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@talkinghead/talkinghead@latest/dist/TalkingHead.min.js"></script>
  <style>
    :root { --bg:#000; --card:#111; --text:#eee; --accent:#ff9500; --border:#30363d; }
    [data-theme="light"] { --bg:#fff; --card:#f5f5f5; --text:#333; --accent:#007bff; --border:#ddd; }
    * { box-sizing:border-box; margin:0; padding:0; }
    body { background:var(--bg); color:var(--text); font-family:'Inter',sans-serif; overflow:hidden; height:100vh; display:flex; flex-direction:column; }

    #hamburger { position:fixed; top:12px; left:12px; z-index:1000; width:48px; height:48px; background:var(--card); border:1px solid var(--border); border-radius:50%; display:grid; place-items:center; cursor:pointer; }
    #hamburger svg { width:28px; height:28px; fill:var(--text); }

    #overlay { position:fixed; inset:0; background:rgba(0,0,0,0.8); opacity:0; pointer-events:none; transition:opacity .3s; z-index:998; }
    #overlay.open { opacity:1; pointer-events:all; }

    #sidePanel { position:fixed; top:0; left:-360px; width:340px; max-width:90vw; height:100%; background:var(--card); border-right:1px solid var(--border); transition:left .3s; z-index:999; padding:16px; overflow-y:auto; }
    #sidePanel.open { left:0; }

    .logo-header { text-align:center; padding:20px 0 30px; border-bottom:1px solid var(--border); margin-bottom:20px; }
    .logo-header img { width:90px; height:90px; border-radius:50%; }
    .logo-header h1 { margin-top:12px; font-size:1.3em; background:linear-gradient(90deg,#ff9500,#ff5e00); -webkit-background-clip:text; color:transparent; }

    .card { background:var(--card); border:1px solid var(--border); border-radius:12px; padding:16px; margin-bottom:16px; }
    h2 { font-size:1.1em; margin-bottom:12px; opacity:0.9; color:var(--accent); }
    .row { display:flex; flex-wrap:wrap; gap:10px; margin-bottom:10px; align-items:center; }
    button, select { background:var(--card); border:1px solid var(--border); color:var(--text); border-radius:8px; padding:10px 14px; min-height:48px; cursor:pointer; font-size:1em; }
    button:hover { background:var(--border); }
    .small { font-size:0.85em; opacity:0.8; }

    #previewWrap { flex:1; position:relative; background:#000; overflow:hidden; }
    #preview { width:100%; height:100%; object-fit:contain; touch-action:none; background:#000; }

    #bottomBar { height:70px; background:var(--card); border-top:1px solid var(--border); display:flex; align-items:center; padding:0 16px; gap:12px; flex-wrap:wrap; }
    #startRec { background:linear-gradient(90deg,#ff5e00,#ff9500); color:white; font-weight:700; }

    .layers { max-height:40vh; overflow-y:auto; }
    .layer { display:grid; grid-template-columns:auto 1fr auto auto auto; gap:8px; align-items:center; padding:8px 0; border-bottom:1px solid var(--border); font-size:0.9em; }

    #avatarContainer { position:absolute; inset:0; pointer-events:none; z-index:5; }
    #animatedOverlay { position:absolute; bottom:100px; left:50%; transform:translateX(-50%); background:rgba(0,0,0,0.7); padding:15px 30px; border-radius:30px; color:white; font-size:2em; font-weight:bold; display:none; z-index:10; }
  </style>
</head>
<body data-theme="dark">

  <div id="hamburger" onclick="togglePanel()">
    <svg viewBox="0 0 24 24"><path d="M3,6H21V8H3V6M3,11H21V13H3V11M3,16H21V18H3V16Z"/></svg>
  </div>

  <div id="overlay" onclick="togglePanel()"></div>

  <div id="sidePanel">
    <div class="logo-header">
      <img src="https://placehold.co/90x90/ff9500/ffffff?text=MS" alt="Logo">
      <h1>Mini Streamer v5</h1>
    </div>

    <div class="card">
      <h2>Sources</h2>
      <div class="row">
        <button id="btnWebcam">Webcam</button>
        <button id="btnScreen">Screen Share</button>
        <button id="btnVideoFile">Video File</button>
      </div>
      <div class="row">
        <button id="btnImage">Image / GIF</button>
        <button id="btnLogo">Logo</button>
        <button id="btnBackground">Background</button>
      </div>
    </div>

    <div class="card">
      <h2>Overlays</h2>
      <div class="row">
        <button id="btnText">Add Text</button>
        <button id="btnTimer">Countdown Timer</button>
        <button id="btnTriggerAnimation">Trigger Alert</button>
      </div>
    </div>

    <div class="card">
      <h2>Avatar (Lip-Sync)</h2>
      <button id="btnLoadAvatar">Load Talking Avatar</button>
    </div>

    <div class="card">
      <h2>Layers</h2>
      <div class="small">Tap & drag â€¢ Corner = resize</div>
      <div id="layersList" class="layers"></div>
    </div>

    <input type="file" id="imageInput" accept="image/*" hidden>
    <input type="file" id="videoInput" accept="video/*" hidden>
    <input type="file" id="bgInput" accept="image/*,video/*" hidden>
  </div>

  <div id="previewWrap">
    <canvas id="preview" width="1920" height="1080"></canvas>
    <div id="avatarContainer"></div>
    <div id="animatedOverlay">New Follower!</div>
  </div>

  <div id="bottomBar">
    <button id="startRec">RECORD</button>
    <button id="streamRecorded">Play Recorded</button>
    <button id="goLive">GO LIVE (Millicast)</button>
  </div>

  <!-- Millicast SDK -->
  <script src="https://cdn.jsdelivr.net/npm/@millicast/sdk@latest/dist/millicast.umd.js"></script>
  <script defer src="script.js"></script>
</body>
</html>
